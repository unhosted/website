function ContactElement(b,a,c,d,e){this.name=b;this.id=a;this.email=c;this.phone=d;this.storagePlace=e;this.getName=function(){return this.name};this.setId=function(f){this.id=f};this.getId=function(){return this.id};this.setEmail=function(f){this.email=f};this.getEmail=function(){return this.email};this.setPhone=function(f){this.phone=f};this.getPhone=function(){return this.phone};this.getStorage=function(){return this.storagePlace}}
function createStorageObject(){for(var b=[],a=0,c=0;c<remoteStorage.length;c++){if(remoteStorage.getItem(a)){var d=remoteStorage.getItem(a).split("|&|");b[c]=new ContactElement(d[0],c,d[1],d[2],a)}else c--;a++}return b}
function populateSearchBox(){var b=[],a=[];b=createStorageObject();for(var c=0;c<b.length;c++){a[c]=[];a[c][0]=b[c].getName();a[c][1]=b[c].getStorage()}a.sort();b=document.getElementById("search_contacts");c=document.createElement("option");c.value="all";c.text="All";try{b.add(c,null)}catch(d){b.add(c)}for(c=0;c<a.length;c++){var e=document.createElement("option");e.value=a[c][1];e.text=a[c][0];try{b.add(e,null)}catch(f){b.add(e)}}return true}
function displayContactHTML(b){var a=[];a=createStorageObject();var c="";c+=a[b].getEmail()===""?"<li>"+a[b].getName()+"<br>--<br>"+a[b].getPhone()+'<br><button type="button" onclick="editContact(\''+a[b].getStorage()+'\');">Edit</button> <button type="button" onclick="deleteContact(\''+a[b].getStorage()+"');\">Remove</button></li>":a[b].getPhone()===""?"<li>"+a[b].getName()+'<br><a href="mailto:'+a[b].getEmail()+'" title="Send '+a[b].getName()+' an email">'+a[b].getEmail()+'</a><br>--<br><button type="button" onclick="editContact(\''+
a[b].getStorage()+'\');">Edit</button> <button type="button" onclick="deleteContact(\''+a[b].getStorage()+"');\">Remove</button></li>":"<li>"+a[b].getName()+'<br><a href="mailto:'+a[b].getEmail()+'" title="Send '+a[b].getName()+' an email">'+a[b].getEmail()+"</a><br>"+a[b].getPhone()+'<br><button type="button" onclick="editContact(\''+a[b].getStorage()+'\');">Edit</button> <button type="button" onclick="deleteContact(\''+a[b].getStorage()+"');\">Remove</button></li>";return c}
function displayContacts(){createStorageObject();for(var b="",a=0;a<remoteStorage.length;a++)b+=displayContactHTML(a);document.getElementById("contacts").innerHTML=b}function getDataElements(){for(var b=remoteStorage.length;remoteStorage.getItem(b);)b++;document.getElementById("id_field").value=b;if(remoteStorage.length>0){document.getElementById("search_contacts").disabled=false;displayContacts()}else document.getElementById("search_contacts").disabled=true;return true}
function showContact(){var b=document.getElementById("search_contacts").value;if(b===""||b=="all")getDataElements();else{var a=[];a=createStorageObject();for(var c=0;c<a.length;c++)if(a[c].getStorage()==b){htmlListItems=displayContactHTML(c);document.getElementById("contacts").innerHTML="";document.getElementById("contacts").innerHTML=htmlListItems;break}}return true}function startAddressBook(){populateSearchBox();showContact();return true}
function submitContact(){var b=document.getElementById("id_field").value,a=document.getElementById("name_field").value,c=document.getElementById("email_field").value,d=document.getElementById("phone_field").value;if(a===""||a===""&&c===""||a===""&&d===""||c===""&&d===""){alert("You have to write a name and at least fill the Email or Phone field.");stop()}else{remoteStorage.setItem(b,a+"|&|"+c+"|&|"+d);return true}return true}
function editContact(b){b=parseInt(b,10);var a=[];a=createStorageObject();for(var c=0;c<a.length;c++)if(a[c].getStorage()==b){document.getElementById("id_field").value=a[c].getStorage();document.getElementById("name_field").value=a[c].getName();document.getElementById("email_field").value=a[c].getEmail();document.getElementById("phone_field").value=a[c].getPhone();break}return true}
function deleteContact(b){var a=[];b=parseInt(b,10);a=createStorageObject();for(var c=0;c<a.length;c++)if(a[c].getStorage()===b){if(confirm("Are you sure you want to permanently remove the entry for "+a[c].getName()+"?")===true){remoteStorage.removeItem(a[c].getStorage());window.location.reload()}break}return true}function clearAllData(){confirm("Are you sure you want to permanently remove all contacts?")===true&&remoteStorage.clear();window.location.reload();return true};